import numpy as np

df["Person_ID"] = df.index.astype("int64")

for k in range(7):
    key = f"match_key_{k}"
    mask = df[key].notna()

    group_min = df.loc[mask].groupby(key)["Person_ID"].transform("min")

    df.loc[mask, "Person_ID"] = np.minimum(
        df.loc[mask, "Person_ID"].to_numpy(),
        group_min.to_numpy()
    )
